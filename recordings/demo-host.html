<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Monaco Recorder Demos</title>
  <style>
    :root {
      --primary: #4a90e2;
      --bg: #1e1e1e;
      --surface: #252526;
      --border: #444;
      --text: #f0f0f0;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    
    .header {
      padding: 1rem;
      background: var(--surface);
      border-bottom: 1px solid var(--border);
    }
    
    .container {
      flex: 1;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
    }
    
    .demo-container {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .demo-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .demo-title {
      font-size: 1.5rem;
      color: var(--primary);
      margin: 0;
    }
    
    .demo-description {
      margin: 0.5rem 0 1rem;
      color: #aaa;
    }
    
    .editor-container {
      flex: 1;
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
    }
    
    .controls {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    
    button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
    }
    
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .demo-list {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    
    .demo-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 1rem;
      cursor: pointer;
      width: 200px;
    }
    
    .demo-card:hover {
      border-color: var(--primary);
    }
    
    .demo-card.active {
      border-color: var(--primary);
      box-shadow: 0 0 0 1px var(--primary);
    }
    
    .demo-card h3 {
      margin: 0 0 0.5rem;
      color: var(--primary);
    }
    
    .demo-card p {
      margin: 0;
      font-size: 0.9rem;
      color: #aaa;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Monaco Recorder Demos</h1>
  </div>
  
  <div class="container">
    <div class="demo-container">
      <div class="demo-header">
        <div>
          <h2 class="demo-title" id="demoTitle">Select a demo</h2>
          <p class="demo-description" id="demoDescription">Choose a demo from the list below</p>
        </div>
        <div class="controls">
          <button id="prevBtn" disabled>Previous</button>
          <button id="nextBtn">Next</button>
        </div>
      </div>
      
      <div class="editor-container" id="editor"></div>
      
      <div class="controls">
        <button id="playPauseBtn">Play</button>
        <button id="stopBtn" disabled>Stop</button>
        <div style="flex: 1"></div>
        <div>Speed: 
          <select id="speedSelect">
            <option value="0.5">0.5x</option>
            <option value="1" selected>1x</option>
            <option value="2">2x</option>
            <option value="5">5x</option>
          </select>
        </div>
      </div>
    </div>
    
    <h3>Available Demos</h3>
    <div class="demo-list" id="demoList">
      <!-- Demo cards will be added here -->
    </div>
  </div>

  <script src="https://unpkg.com/monaco-editor@0.45.0/min/vs/loader.js"></script>
  <script>
    // Demo configurations
    const DEMOS = [
      {
        id: 'basic-usage',
        title: 'Basic Usage',
        description: 'Learn how to record and play back editor actions',
        recording: 'samples/basic-usage.json',
        code: '// Basic Usage Example\nconst { createMonacoRecorder } = window.monacoRecorder;\n\n// Create editor instance\nconst editor = monaco.editor.create(\n  document.getElementById(\'editor\'),\n  { value: \'// Start recording...\\n\' }\n);\n\n// Initialize recorder\nconst recorder = createMonacoRecorder(editor);\n\n// Start recording\nrecorder.start();\n\n// Stop recording\n// recorder.stop();\n\n// Play recording\n// recorder.play();',
        language: 'javascript'
      },
      {
        id: 'custom-events',
        title: 'Custom Events',
        description: 'Using custom events with the recorder',
        recording: 'samples/custom-events.json',
        code: '// Custom Events Example\nconst recorder = createMonacoRecorder(editor, {\n  onStart: () => console.log(\'Recording started\'),\n  onStop: () => console.log(\'Recording stopped\'),\n  onPlay: () => console.log(\'Playback started\'),\n  onPause: () => console.log(\'Playback paused\'),\n  onEnd: () => console.log(\'Playback finished\')\n});',
        language: 'javascript'
      },
      {
        id: 'react-integration',
        title: 'React Integration',
        description: 'Using Monaco Recorder in a React app',
        recording: 'samples/react-integration.json',
        code: '// React Integration Example\nimport { useEffect, useRef } from \'react\';\nimport * as monaco from \'monaco-editor\';\nimport { createMonacoRecorder } from \'monaco-recorder\';\n\nfunction EditorWithRecorder() {\n  const editorRef = useRef(null);\n  const recorderRef = useRef(null);\n  \n  useEffect(() => {\n    // Initialize editor\n    const editor = monaco.editor.create(\n      editorRef.current,\n      { value: \'// Start coding...\\n\' }\n    );\n    \n    // Initialize recorder\n    recorderRef.current = createMonacoRecorder(editor);\n    \n    return () => editor.dispose();\n  }, []);\n  \n  return (\n    <div>\n      <div ref={editorRef} style={{ height: \'300px\' }} />\n      <button onClick={() => recorderRef.current.start()}>\n        Start Recording\n      </button>\n    </div>\n  );\n}',
        language: 'typescript'
      }
    ];
    
    // App state
    let editor;
    let currentDemoIndex = 0;
    let recorder;
    
    // Initialize the app
    window.require.config({ paths: { vs: 'https://unpkg.com/monaco-editor@0.45.0/min/vs' }});
    window.require(['vs/editor/editor.main'], () => {
      initEditor();
      loadDemo(0);
      setupEventListeners();
      renderDemoList();
    });
    
    function initEditor() {
      editor = monaco.editor.create(document.getElementById('editor'), {
        value: '// Select a demo to begin\n',
        language: 'javascript',
        theme: 'vs-dark',
        minimap: { enabled: true },
        automaticLayout: true
      });
    }
    
    function loadDemo(index) {
      if (index < 0 || index >= DEMOS.length) return;
      
      currentDemoIndex = index;
      const demo = DEMOS[index];
      
      // Update UI
      document.getElementById('demoTitle').textContent = demo.title;
      document.getElementById('demoDescription').textContent = demo.description;
      
      // Update editor
      const model = monaco.editor.createModel(
        demo.code,
        demo.language
      );
      
      if (editor.getModel()) {
        editor.getModel().dispose();
      }
      editor.setModel(model);
      
      // Initialize recorder
      if (recorder) {
        recorder.dispose();
      }
      
      // Load recording if available
      loadRecording(demo.recording);
      
      // Update navigation buttons
      document.getElementById('prevBtn').disabled = index === 0;
      document.getElementById('nextBtn').disabled = index === DEMOS.length - 1;
      
      // Update active demo card
      document.querySelectorAll('.demo-card').forEach((card, i) => {
        if (i === index) {
          card.classList.add('active');
        } else {
          card.classList.remove('active');
        }
      });
    }
    
    async function loadRecording(recordingPath) {
      try {
        const response = await fetch(recordingPath);
        const events = await response.json();
        
        // Initialize recorder with loaded events
        recorder = window.monacoRecorder.createMonacoRecorder(editor, {
          events,
          playbackSpeed: parseFloat(document.getElementById('speedSelect').value)
        });
        
        // Set up event listeners
        recorder.on('play', () => {
          document.getElementById('playPauseBtn').textContent = 'Pause';
          document.getElementById('stopBtn').disabled = false;
        });
        
        recorder.on('pause', () => {
          document.getElementById('playPauseBtn').textContent = 'Resume';
        });
        
        recorder.on('end', () => {
          document.getElementById('playPauseBtn').textContent = 'Play';
          document.getElementById('stopBtn').disabled = true;
        });
        
        // Enable playback controls
        document.getElementById('playPauseBtn').disabled = false;
        
      } catch (error) {
        console.error('Failed to load recording:', error);
        recorder = window.monacoRecorder.createMonacoRecorder(editor);
        document.getElementById('playPauseBtn').disabled = true;
        document.getElementById('stopBtn').disabled = true;
      }
    }
    
    function renderDemoList() {
      const demoList = document.getElementById('demoList');
      demoList.innerHTML = '';
      
      DEMOS.forEach((demo, index) => {
        const card = document.createElement('div');
        card.className = 'demo-card' + (index === currentDemoIndex ? ' active' : '');
        card.innerHTML = `
          <h3>${demo.title}</h3>
          <p>${demo.description}</p>
        `;
        card.addEventListener('click', () => loadDemo(index));
        demoList.appendChild(card);
      });
    }
    
    function setupEventListeners() {
      // Navigation
      document.getElementById('prevBtn').addEventListener('click', () => {
        loadDemo(currentDemoIndex - 1);
      });
      
      document.getElementById('nextBtn').addEventListener('click', () => {
        loadDemo(currentDemoIndex + 1);
      });
      
      // Playback controls
      document.getElementById('playPauseBtn').addEventListener('click', () => {
        if (!recorder) return;
        
        if (recorder.isPlaying()) {
          recorder.pause();
        } else {
          recorder.play();
        }
      });
      
      document.getElementById('stopBtn').addEventListener('click', () => {
        if (recorder) {
          recorder.stop();
        }
      });
      
      // Speed control
      document.getElementById('speedSelect').addEventListener('change', (e) => {
        if (recorder) {
          recorder.setPlaybackSpeed(parseFloat(e.target.value));
        }
      });
    }
  </script>
</body>
</html>
